import{f as p}from"./vendor.595f6ddc.js";const I=function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))s(e);new MutationObserver(e=>{for(const t of e)if(t.type==="childList")for(const a of t.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function i(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),e.crossorigin==="use-credentials"?t.credentials="include":e.crossorigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function s(e){if(e.ep)return;e.ep=!0;const t=i(e);fetch(e.href,t)}};I();var b="/app/views",B="/",E=".html";document.addEventListener("DOMContentLoaded",function(){if(window.location.pathname.trim()!=="/"){var o=window.location.pathname.split("/"),n=b+B+o[1]+E;console.log(n,m(n));var i=jQuery("div#app-main").find("div[data-type=page]");jQuery.each(i,(s,e)=>{jQuery(e).hide(),jQuery(e).attr("data-page")===o[1]&&(jQuery(e).append(m(n)),jQuery(e).show(),console.log(e))})}});function m(o){return jQuery.ajax({type:"GET",url:o,async:!1}).responseText.split('<script type="module" src="/@vite/client"><\/script>')[1].trim()}const S={apiKey:"AIzaSyD97htkcHomWx6ZQzo8HlAyaW6MDIE8b18",authDomain:"webrtctest-f94d7.firebaseapp.com",projectId:"webrtctest-f94d7",storageBucket:"webrtctest-f94d7.appspot.com",messagingSenderId:"783159718748",appId:"1:783159718748:web:37c2517d8315b6dfca0799",measurementId:"G-EM5TH91BP3"};p.apps.length||p.initializeApp(S);const w=p.firestore(),v={iceServers:[{urls:["stun:stun1.l.google.com:19302","stun:stun2.l.google.com:19302"]}],iceCandidatePoolSize:10},c=new RTCPeerConnection(v);let l=null,f=null;const y=document.getElementById("webcamButton"),T=document.getElementById("webcamVideo"),g=document.getElementById("callButton"),C=document.getElementById("callInput"),h=document.getElementById("answerButton"),j=document.getElementById("remoteVideo"),k=document.getElementById("hangupButton");y.onclick=async()=>{l=await navigator.mediaDevices.getUserMedia({video:!0,audio:!0}),f=new MediaStream,l.getTracks().forEach(o=>{c.addTrack(o,l)}),c.ontrack=o=>{console.log(o.streams[0].getTracks()),o.streams[0].getTracks().forEach(n=>{f.addTrack(n)})},T.srcObject=l,j.srcObject=f,g.disabled=!1,h.disabled=!1,y.disabled=!0};g.onclick=async()=>{const o=w.collection("calls").doc(),n=o.collection("offerCandidates"),i=o.collection("answerCandidates");C.value=o.id,c.onicecandidate=t=>{t.candidate&&n.add(t.candidate.toJSON())};const s=await c.createOffer();await c.setLocalDescription(s);const e={sdp:s.sdp,type:s.type};await o.set({offer:e}),o.onSnapshot(t=>{const a=t.data();if(!c.currentRemoteDescription&&(a==null?void 0:a.answer)){const r=new RTCSessionDescription(a.answer);c.setRemoteDescription(r)}}),i.onSnapshot(t=>{t.docChanges().forEach(a=>{if(a.type==="added"){const r=new RTCIceCandidate(a.doc.data());c.addIceCandidate(r)}})}),k.disabled=!1};h.onclick=async()=>{const o=C.value,n=w.collection("calls").doc(o),i=n.collection("answerCandidates"),s=n.collection("offerCandidates");c.onicecandidate=d=>{d.candidate&&i.add(d.candidate.toJSON())};const t=(await n.get()).data().offer;await c.setRemoteDescription(new RTCSessionDescription(t));const a=await c.createAnswer();await c.setLocalDescription(a);const r={type:a.type,sdp:a.sdp};await n.update({answer:r}),s.onSnapshot(d=>{d.docChanges().forEach(u=>{if(console.log(u),u.type==="added"){let D=u.doc.data();c.addIceCandidate(new RTCIceCandidate(D))}})})};
